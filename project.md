# Windows 桌面任务管理软件开发文档（轻量级 · 本地保存 · 自动恢复）

## 项目目标

开发一款轻量级 Windows 桌面应用程序（`.exe`），用于每日任务表格管理，支持多标签、字段自定义、自动保存与恢复、本地存储、开机自启，无需后端与数据库，界面简洁、运行快速、适合长期使用。

---

## 技术方案

| 项目 | 选型 |
|------|------|
| 主语言 | C# |
| 框架 | WinForms (.NET 6+) |
| IDE | Visual Studio Community |
| 存储方式 | 本地 JSON 文件（每次操作自动保存） |
| 图片存储 | 存储为本地文件 + JSON 路径引用 |
| 打包方式 | Visual Studio 发布功能 / ClickOnce |
| 开机启动 | 注册表自启动（或复制快捷方式到启动文件夹） |

---

## 功能模块设计

### 1. 多标签页（Tab）系统

- 支持任意创建多个任务表标签（Tab）
- 每个标签代表一个任务表（表结构和数据独立）
- 标签可重命名 / 关闭 / 切换
- 启动时自动恢复上次打开的所有标签页和内容

### 2. 自定义字段支持

每个表格支持多个字段列，自定义字段类型包括：

| 字段类型 | 描述 |
|----------|------|
| 文本输入 | 自由输入内容 |
| 单选（状态标记） | 自定义选项 + 颜色（如：未开始/进行中/完成） |
| 多选标签 | 可勾选多个分类，如“紧急/今日/延后” |
| 图片上传 | 上传本地图片显示于单元格内，存储路径保存至 JSON |

可操作：

- 添加 / 删除列
- 修改列名与字段类型
- 列顺序调整（可选）

### 3. 表格内容管理（每行为一项任务）

- 可添加 / 删除行
- 各字段单元格均可实时编辑
- 支持图标按钮打开图片预览或放大查看

### 4. 自动保存与本地数据结构

- 所有操作自动保存，无需手动点击
- 数据保存路径：`%APPDATA%\TaskBoard\data.json`
- 采用 `debounce` 策略避免频繁写入

### 5. 开机自启动功能

- 自动添加注册表项：`HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`
- 或在 `C:\Users\<用户名>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup` 中添加快捷方式
- 用户可在设置中开启 / 关闭此功能

### 6. 用户设置与持久化内容

- 所有以下内容将在下次启动时自动恢复：
  - 所有标签页名称及数量
  - 每个表格的字段定义、字段类型
  - 所有任务项数据
  - 各字段的选项配置（颜色、值）
  - 应用窗口尺寸与位置（可选）

---

## 数据结构示例（JSON）

```json
{
  "tabs": [
    {
      "id": "tab1",
      "name": "每日计划",
      "columns": [
        { "id": "c1", "name": "任务", "type": "text" },
        { "id": "c2", "name": "状态", "type": "single", "options": [
          { "label": "未开始", "color": "#ccc" },
          { "label": "进行中", "color": "#f90" },
          { "label": "已完成", "color": "#0c0" }
        ]},
        { "id": "c3", "name": "标签", "type": "multi", "options": ["重要", "学习", "明天"] },
        { "id": "c4", "name": "截图", "type": "image" }
      ],
      "rows": [
        {
          "id": "r1",
          "data": {
            "c1": "写日报",
            "c2": "进行中",
            "c3": ["重要", "学习"],
            "c4": "images/2025-07-24-1.png"
          }
        }
      ]
    }
  ]
}

